:ruby
  measures = ClaimsReporting::QualityMeasuresReport::AVAILABLE_MEASURES
  reports = ['2018', '2019', '2020', '2021'].map do |year|
    ClaimsReporting::QualityMeasuresReport.for_plan_year(year)
  end
  f = ClaimsReporting::Formatter.new

  # subpopulations
  # By ACO
  # My Patients
  # Race/Gender/Age?
.row
  .col-12
    .pb-4
      %h3 MassHealth BH CP Quality Measures
      %table.table.table-sm.table-striped
        %thead
          %tr
            %th{rowspan: 2} Measure
            - reports.each do |report|
              %th{colspan: 3}= report.title
          %tr
            - reports.each do |report|
              %th{style: 'border-left: 1px solid'}
                Value
              %th
                Num.
              %th
                Denom.
        - measures.each do |measure_id, info|
          %tr
            %td
              %div
                %b= info.title
              = simple_format info.desc
            - reports.each do |report|
              - data = report.measure_value(measure_id)
              %td.text-right{style: 'border-left: 1px solid'}
                - if data[:value].present?
                  - if data[:denominator]
                    = f.format_pct(data[:value] * 100.0)
                  - else
                    = f.format_d(data[:value])
                -
                  = "n/a"
              %td
                .text-center{data: {toggle: :tooltip, title: info.numerator}}
                  = f.format_i(data[:numerator]) if data[:numerator].present?
              %td
                .text-center{data: {toggle: :tooltip, title: info.denominator}}
                  = f.format_i(data[:denominator]) if data[:denominator].present?
