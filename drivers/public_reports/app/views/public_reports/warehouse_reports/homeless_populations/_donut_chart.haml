- active_date = data.keys.first
%h2= data[active_date]['title']
.jQuarterChosenDate
.chart.pt-2{ data: { active_date: data.keys.first }, class: [chart_class, "active_date_#{data.keys.first}"]}

:javascript
  var controller;
  var dates = #{data.to_json.to_s.html_safe};
  var active_date = $(".#{chart_class}").data('activeDate');
  var chart = bb.generate({
    data: {
      columns: [],
      type: 'donut'
    },
    donut: {
      label: {
        format: d => d
      }
    },
    bindto: {
      element: ".#{chart_class}"
    },
    color: {
      pattern: #{@report.chart_color_pattern}
    },
    labels: {
      format: function(v, id, i, j) {
        if (v > 8) {
          return v + '%';
        }
      }
    }
  });
  // Make the page aware of the new chart
  var charts = $('body').data('publicCharts');
  if(charts == undefined) {
    charts = []
  }
  charts.push({ chart: chart, dates: dates })
  $('body').data('publicCharts', charts);
  $('.jQuarters').trigger('change');
