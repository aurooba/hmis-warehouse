- content_for :title, @title
%h1= @title
= render '/warehouse_reports/breadcrumbs', tab: 'data-quality'
%p View differences between the client's self-reported start date (DateToStreetESSH) and the actual entry date.
= render 'filter'
- if !@pagy.present?
  %p.text-center Apply filters to see results.
- elsif @pagy.count.positive?
  .d-flex
    .ml-auto.mb-4
      = link_to({format: :xlsx}.merge(link_params),{class: 'btn btn-secondary ml-auto'}) do
        %i.icon-download2
        Download
  .d-flex
    %p!= pagy_info(@pagy, item_name: _('enrollment').pluralize(@pagy.count))
    %p.ml-auto!= pagy_bootstrap_nav(@pagy)
  = render 'warehouse_reports/limited_by_project_note'
  .card
    %table.mb-0.table.table-striped
      %thead
        %tr
          %th Client
          %th # Days Difference
          %th DateToStreetESSH
          %th Entry Date
          %th Personal ID
          %th Project
          %th Project Type
      %tbody
        - @enrollments.each do |en|
          - client = en.client
          - date_to_street = en.enrollment.DateToStreetESSH
          - entry_date = en.enrollment.EntryDate
          - difference_in_days = (entry_date - date_to_street).to_i
          %tr
            %td= link_to_if can_view_clients?, client.name, appropriate_client_path(client)
            %td= difference_in_days
            %td= date_to_street
            %td= entry_date
            %td= en.enrollment.PersonalID
            %td= GrdaWarehouse::Hud::Project.confidentialize(name: en.project&.name)
            %td
              .enrollment__project_type{class: "client__service_type_#{en.project_type}"}
                .service-type__program-type{data: {toggle: :tooltip, title: HUD.project_type(en.project_type)}}
                  = HUD.project_type_brief en.project_type
- else
  %p.text-center No enrollments found
